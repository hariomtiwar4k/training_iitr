# -*- coding: utf-8 -*-
"""Copy of Day3 salary prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/19ko0pkFEjr9QTfcevuJfXGbWNY7rvQIP
"""

import pandas as pd
import matplotlib.pyplot as plt

data = pd.read_csv("Salary_Data.csv")
data.head()

len(data)

x =data.iloc[:,0].values
y =data.iloc[:,1].values

x

y

x.shape

y.shape

x = x.reshape(len(x),1)
y = y.reshape(len(y),1)

x.shape

from sklearn.model_selection import train_test_split
xtrain,xtest,ytrain,ytest=train_test_split(x,y,test_size=0.2)

len(xtrain)

from sklearn.linear_model import LinearRegression
model = LinearRegression()

model.fit(xtrain,ytrain)

ypred = model.predict(xtest)
ypred

ytest

from sklearn.metrics import r2_score
r2 = r2_score(ytest,ypred)
r2

m = model.coef_
c=model.intercept_
print(m,c)

20.1*m+c

model.predict([[20.1]])

plt.scatter(xtrain,ytrain,color="purple")
plt.plot(xtrain,model.predict(xtrain),color='red')
plt.show()

plt.scatter(xtest,ytest,color="purple")
plt.plot(xtest,model.predict(xtest),color='red')
plt.show()

from sklearn.externals import joblib
joblib.dump(model,"mymodel.pkl")

mymodel = joblib.load('mymodel.pkl')
mymodel.predict([[20.1]])

